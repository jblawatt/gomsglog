{"version":3,"sources":["gomsglog.jsx"],"names":["_itemStorage","FormComp","onSubmit","evt","preventDefault","input","currentTarget","querySelector","setAttribute","message","value","method","getAttribute","action","m","request","url","headers","data","then","removeAttribute","unshift","r","view","RemoveLinkComponent","vnode","item","attrs","href","confirm","filter","i","ID","catch","alert","e","console","error","ListItemComponent","CreatedAt","trust","HTML","ListComponent","rargs","loadData","map","RootComp","mount","document","getElementById"],"mappings":"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","file":"gomsglog.js","sourcesContent":["\r\nlet _itemStorage = [];\r\n\r\nlet FormComp = {\r\n    onSubmit(evt) {\r\n        evt.preventDefault();\r\n        let input = evt.currentTarget.querySelector('.message');\r\n        input.setAttribute(\"disabled\", true);\r\n        let message = input.value;\r\n        let method = evt.currentTarget.getAttribute(\"method\");\r\n        let action = evt.currentTarget.getAttribute(\"action\");\r\n        m.request({\r\n            url: action,\r\n            method,\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            data: {\r\n                message\r\n            }\r\n        }).then(r => {\r\n            input.value = \"\";\r\n            input.removeAttribute(\"disabled\");\r\n            _itemStorage.unshift(r);\r\n        });\r\n        return false;\r\n    },\r\n    view() {\r\n        return (\r\n            <div >\r\n                <form method=\"POST\" action=\"/api/messages\" onsubmit={this.onSubmit}>\r\n                    <input type=\"text\" class=\"message u-full-width\" placeholder=\"your message\"></input>\r\n                    <br />\r\n                    <input type=\"submit\" value=\"weg schicken\" class=\"button-primary\"></input>\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n};\r\n\r\n\r\nlet RemoveLinkComponent = {\r\n    view(vnode) {\r\n        let item = vnode.attrs.item;\r\n        return <a href={vnode.attrs.href} onclick={(evt) => {\r\n            evt.preventDefault();\r\n            if (!confirm(\"What, really delete??\")) return false;\r\n            _itemStorage = _itemStorage.filter(i => i != item);\r\n            m.request({\r\n                url: vnode.attrs.href,\r\n                method: 'DELETE',\r\n                data: { ID: item.ID },\r\n            }).catch(e => {\r\n                alert(e);\r\n                console.error(e);\r\n            });\r\n            return false;\r\n        }}>x</a>\r\n    }\r\n}\r\n\r\n\r\nlet ListItemComponent = {\r\n    view(vnode) {\r\n        let item = vnode.attrs.item;\r\n        return (\r\n            <tr key={item.ID}>\r\n                <td>#{item.ID}</td>\r\n                <td>{item.CreatedAt}</td>\r\n                <td>{m.trust(item.HTML)}</td>\r\n                <td>\r\n                    <RemoveLinkComponent item={item} href=\"/api/messages/:ID\" />\r\n                </td>\r\n            </tr>\r\n        );\r\n    }\r\n}\r\n\r\nclass ListComponent {\r\n    loadData(url) {\r\n        let rargs = {\r\n            url: url,\r\n            method: 'GET',\r\n        };\r\n        m.request(rargs).then(r => {\r\n            _itemStorage = r;\r\n        });\r\n    }\r\n    oncreate(vnode) {\r\n        this.loadData(vnode.attrs.url);\r\n    }\r\n    view(vnode) {\r\n        return (\r\n            <div className=\"container\">\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>ID</th>\r\n                            <th>Created</th>\r\n                            <th>Message</th>\r\n                            <th>Action</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {\r\n                            _itemStorage.map(i => {\r\n                                return <ListItemComponent item={i} />\r\n                            })\r\n                        }\r\n                        <tr>\r\n                            <td colspan=\"4\">\r\n                                <FormComp />\r\n                            </td>\r\n\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div >\r\n        );\r\n    }\r\n};\r\n\r\nclass RootComp {\r\n    view(vnode) {\r\n        return <ListComponent url=\"/api/messages\" />;\r\n    }\r\n}\r\n\r\nm.mount(document.getElementById(\"app\"), RootComp);\r\n"]}